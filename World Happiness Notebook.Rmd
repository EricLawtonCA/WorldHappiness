---
title: "World Happiness Report Analysis"
author: "Eric Lawton"
date: March 21, 2017
output: html_notebook 
---
# About this page
This analysis of the [World Happiness Report (WHR)](http://worldhappiness.report/) is an R notebook, which consists of text like this and the computer code required to perform the analyis, which is mostly displayed in graphical plots. It is written in the R statistical programming language. If you are not interested in the code, just select the option button "Code" at the top right of this page, and then "Hide all code". There are also individual "Code" buttons to hide or view individual chunks of code. 
The WHR itself is available as a complete PDF report, with much analysis. That will not be repeated here. If you are interested in this topic, I recommend you read it as well. Here, I intend to look at additional aspects not covered and to look at how other public data can also shed light on the document.
The first part of this page will be as readable as I can make it. Later parts will provide more detailed statistical analysis, which will "show my work" behind the first part.
## Status
This is a working document. So far, very little has been done, the intent at this point was simply to establish the moving parts. The full project is kept [here, on GitHub] (https://github.com/EricLawtonCA/WorldHappiness) 

# About the World Happiness Report
The Report is based on a survey conducted globally to attempt to replace other, entirely economic, indices by something more meaningful to human beings. 
This applies particularly to Gross Domestic Product, which can measure things like environmental destruction as an economic gain.
## Summary of the data
The happiness index itself is derived simply by asking people to rate their lives as if they were on a ladder of life, with rungs numbered 1 to 10, where “1” is the worst possible life and “10” the best. The public data provides the average (mean) for each country.
There are many other variables provided in the data to measure such things as trust between people, feelings about level of corruption in the country and levels of economic equality. I will explore the relationship between these and then attempt other statistics from other public sources such as OECD statistics.
Here is a look at the latest data, which compares the average person's position on the life ladder with the country's Gross Domestic Product (GDP). As you would expect, there is a rough match between GDP, which is itself a rough match to the country's wealth, and how good a life people think they are leading. However, it varies quite a lot. The blue line represents a kind of average - if a country is on the line, it is where you would expect to find it. If it is above, people are happier than in an average country with the same income; if it is below, people are less happy. As you can see, there are relatively poor countries where people are relatively happy, and there are some rich countries like the Nordic countries that are happier than you would expect them to be, while others at varying wealth levels are not so happy. Of course, this is an overly simplistic analysis, hence the rest of this document.
**Note:** GDP is shown on a *log* scale. That just means that instead of each level of the scale being a fixed number of dollars (or pounds, or...), it represents multiplying the wealth by <span style="color:red">red(need to check the factor)</span>. This is because if you have 

```{r, echo=TRUE, warning=FALSE}
# Packages required - some not used in current version but I expect to use them soon.
library(dplyr)
library(ggrepel)
library(ggplot2)
library(gtable)
library(grid)
library(gridExtra)
library(png)
library(jpeg)
library(gganimate)

# Read the 2017 dataset, saved from Excel as .csv
data.df <- read.csv("data/online+data+chapter+2+whr+2017.csv", stringsAsFactors=FALSE)

# Too many countries to put all their names on the plot, so here is a subset whose names will be plotted
named_countries <- c("Afghanistan","Congo","Sudan","Myanmar","Iraq","Venezuela","Denmark",
                     "India","Russia","Argentina","Greece","Brazil","China","Italy", "Congo (Kinshasa)", "Tanzania",
                     "South Africa","Rwanda", "Bhutan","Botswana","Netherlands","Syria","Central African Republic","South Sudan",
                     "Spain","France", "Barbados","Japan","Germany","Qatar","Luxembourg",
                     "Norway","Singapore","New Zealand","United States", "United Kingdom","Canada")
named_country.df <- subset(data.df,country %in% named_countries)
data.df <- transform(data.df, PrintCountry = ifelse(country %in% named_countries, country, "")) # separate column for named countries only
ggplot(filter(data.df,year == 2016 & !is.na(Log.GDP.per.capita)),aes(y=Life.Ladder,x=Log.GDP.per.capita)) +
  labs(title="Money partly buys happiness") +
  scale_x_continuous(name="GDP per person (log scale)",breaks=seq(0,12,1)) + # various labels
  scale_y_continuous(name="'Best to worst possible life' 1-10",breaks=seq(2,10,1), limits=c(2, 10)) +
  geom_point() +
  geom_smooth(method=lm, se=FALSE) + # Add linear regression line
  # Use "text_repel" to add names of selected countries but if they overlap, offset them a bit until they don't
  geom_text_repel(aes(label=PrintCountry), min.segment.length = unit(0, "lines"), 
                  point.padding = unit(1,"lines"))

```
# Variation by year
ggplot(,aes(y=Life.Ladder,x=country))

```{r}
named_country_2016.df <- filter(data.df,PrintCountry != "" & year == 2016)
named_country_2011.df <- filter(data.df,PrintCountry != "" & year == 2011)
named_country_2016.df$laddergain <- 
  named_country_2016.df$Life.Ladder - named_country_2011.df$Life.Ladder
ggplot(named_country_2016.df, aes(x = reorder(country, laddergain), y = laddergain)) + 
  geom_bar(stat = "identity") + coord_flip()
   

                
```

